2510.25640v1 [quant-ph] 29 Oct 2025

arXiv

Large-scale implementation of quantum subspace expansion with classical shadows

Laurin E. Fischer,'?:* Daniel Bultrini,? Ivano Tavernelli,'

and Francesco Tacchino!

‘IBM Quantum, IBM Research Europe — Zurich, 8808 Riischlikon, Switzerland
? Theory and Simulation of Materials, Ecole Polytechnique Fédérale de Lausanne, 1015 Lausanne, Switzerland
3 Theoretische Chemie, Physikalisch-Chemisches Institut, Heidelberg University, Heidelberg, Germany.
(Dated: October 30, 2025)

Quantum subspace expansion (QSE) offers promising avenues to perform spectral calculations on
quantum processors but comes with a large measurement overhead. Informationally complete (IC)
measurements, such as classical shadows, were recently proposed to overcome this bottleneck. Here,
we report the first large-scale implementation of QSE with IC measurements. In particular, we probe

Introduction—Spectral calculations are a key target

for

so
me

ing

0

Po:
UL)

no

ary circuit approximations, it might stil
ul resource. In fact, there exist several way
can be em
ion. These include, for instance, matrix diagonalization
ased on
samples [5, 6], the extraction of an effective representa-
ion of po
rocessing of the quantum computer outputs via Tensor
Networks

In QSE, a space of states is spanned on top o
po with L Hermitian expansion operators o; as [11
psx(€)
parametrized by a coefficient vector ¢ =
This can be regarded as accessing additional states be-
yond

Until

many-body quantum simulation frameworks.

recently, heuristic approaches based on the variational
quantum eigensolver (VQE) dominated the near-term
quantum computing literature on the
heir relatively low demands on quantum processor per-
ormance [1].
rainability [2] and large measurement overheads [3] have
far hindere
rinciple demonstrations. In response to this, alternative

‘opic, thanks to

However, practical issues connected to

their scalability beyond small proof-of-

hods for calculating ground and excited states are be-
explored. A promising class of post-VQE quantum

algorithms for spectral calculations is quantum subspace
expansion (QSE)
find the energy Egs of a ground state |y_s) of a target
Hamiltonian H, and suppose that a certain “root state”

[4]. Assume that, as usual, the goal is

close to |g) can be prepared on a quantum com-

er. QSE relies on the fact that, while po alone may

yield the desired accuracy, e.g., due to noise or uni-
represent a use-
in which po
loyed to inform a subsequent classical calcula-

rojection into a space spanned by individua

ased on classical shadows [7], and subsequent

8, 9] or Neural Quantum States [10].

= WtpoW/Tr[WtpoW], with W = Th,
(Ci, «

CiDi,

he scope of the quantum processor [12, 13], anc

may also serve as noise-agnostic error mitigation [11, 14—

*

aurQ@zurich.ibm.com

+ fta@zurich.ibm.com

16].

the quantum phase transition of a spin model with three-body interactions, for which we observe
accurate ground state energy recovery and mitigation of local order parameters across system sizes
of up to 80 qubits. We achieve this by reformulating QSE as a constrained optimization problem,
obtaining rigorous statistical error estimates and avoiding numerical ill-conditioning. With over
3 x 10% measurement basis randomizations per circuit and the evaluation of O(10'*) Pauli traces,
this represents one of the most significant experimental realizations of classical shadows to date.

The expectation value of an observable O over a

state in the subspace then becomes

where Oj; = Tr] 21 9000}

For
exp
to

eigenvalue problem H¢ = ASC where H is

pro,

trix.
classical computer

L * .
THOpsa(@)] = Sse,

L
ig=l % cj Sij

and Sj; = Tr [of p00].
ground state search, the goal is to find the minimal
ectation value ming Tr[Hpasx(é)| which corresponds
he smallest pseudoeigenvalue of the generalized
he subspace-
jected Hamiltonian and S is called the overlap ma-
For reasonable values of L, this is tractable on a
by inverting the overlap matrix and

computing the smallest eigenvalue of S~!H. For ground
state calculations, the powers of the Hamiltonian H? are

part:

overlap of the states HP? py H?t (once pro

ize
wit

corresponds to the well-known Krylov subs
ization method [16-19].

‘icularly suitable expaneicg operators. Indeed, the
erly normal-
) with the true ground state increases exponentially
h p, provided po has non-zero overlap with |q{gs). This

ace diagonal-

The main experimental cost of QSE stems from the

humber of measurements re
trix entries Oj; and S;
sion

For
ally

roadblock for scaling in prac
this,
as classical shadows
underlying observables from one se
ples
ized in a series of large-scale experiments

use

uired to estimate all ma-
ij, Which depends on the dimen-
L and the complexity of the expansion operators.
approaches that measure each observable individu-
(or in commuting groups) this can be a significant
ice [20, 21]. To alleviate
informationally complete (IC) measurements, such
[7] (CS) can be used to estimate all
of measurement sam-
22, 23]. CS measurements have recently been real-
24, 25] and the
of CS to systematically build high-dimensional sub-

spaces spanned by low-weight Paulis has been proposed
in Ref. [26]. However, while the latter offered a promis-

ing

avenue, its statistical analysis focused on worst-case

upper bounds rather than reliable statistical error bars
for the resulting estimators. Furthermore, no experimen-
al demonstration of such ideas has been achieved so far.
n this letter, we close both gaps by formulating sub-
space expansion as a constrained optimization problem.
n contrast to previous methods, this allows us to obtain
accurate statistical uncertainties and provides an exter-
nal tuning knob to control these errors, trading potential
ias for variance. Leveraging this technique, we experi-
mentally demonstrate noise-agnostic error mitigation via
QSE in ground state preparation circuits of spin models
‘or systems with up to 80 qubits.

Theory— An IC measurement is described by a
set of n positive semi-definite Hermitian operators
{Me }eeqa,...n} With Sper Me = 1 such that any observ-
able O can be expressed as O = Sea wr My, for some
w, € R [27]. The expectation value (O) then becomes
Tr[p00] = S>), we Tr[0Mz] = Exp, [we], ie., (O) can be
expressed as the mean value of the random variable w,
over the probability distribution {py = Tr[oMx]}. Given
a sample of S' measurement outcomes {k), eeey KS, we
can thus construct an unbiased estimator of (O) as

Ss
, 1
6: {KO (S) ce

The statistical variance of this estimator is given by the
standard error on the mean Var[6] = Var[w,]/S. The
coefficients w, can be obtained from frame theory [28]
where each POVM operator M;, is associated with a dual
operator D;, (also known as the “classical shadow” of a
state) such that wz = Tr[OD,].

Given S POVM outcome samples {k(,..., (5) } mea-
sured from the base state po, we aim to simultaneously
estimate all matrix entries of the projected Hamiltonian
Hi; and the overlap matrix S;;. Following Eq. (2), a
canonical estimator for each matrix element H,; and S;;
is obtained by simply replacing po in each expression with
the corresponding dual operator D;, and then averaging
over all shots. In principle we could estimate all entries
of H and S this way and then solve the generalized eigen-
value problem. However, in practice this direct inversion
of the overlap matrix can be numerically unstable due to
ill-conditioning of the matrix under shot noise and exper-
imental imperfections, particularly when the expansion
operators are non-orthogonal [29]. This issue is often
addressed through regularization of the overlap matrix,
e.g., by discarding dimensions that correspond to smal
singular values of S [13]. Furthermore, since with IC
measurements we do not estimate the matrix entries in-
dependently, additional covariances between them need
to be accounted for when deriving statistical error bars.

Here, we present a different scheme to avoid ill-
conditioning which is tailored to handle such inheren
covariances. Assume that we have an estimator H(é) o:
the energy Tr[Hpgp(@)] of the state at subspace vector ¢
and that we can further estimate the statistical error o
H(@) as €(é). In practice, we would like to compute the
lowest possible subspace energy given a maximally toler-

ated error €max- This is achieved through the constrained
optimization problem

argmin H(@ subject to é(@) < émax. (3)
éeR”

This allows us to explore only those regions of the sub-
space where the statistical error is well controlled. In
contrast to regularization techniques, it offers a direct
tuning knob to trade off statistical errors for potentially
lower estimates of the energy, see Fig 1 and Appendix B 3
for details. .

We now construct the estimators H(é) and é(¢) based
Let c, = Bo ey Tr[D,0; Hot]

and yz, = Wij Cie; Tr[Dojo1] be the random vari-

on IC samples.

ables of the numerator and denominator of Eq. (1) dis-
tributed according to p,. Then the subspace expecta-
tion value Tr[H pasz(©)] = He/ fy is given by the ratio of
Me = Exnp, [ep] and pry = Ex~p, [yx]. An asymptotically-
unbiased and consistent estimator of this ratio is given
by the ratio of the sample means [30]

A(®) :{k,..., kD} ar (4)

with = ws 1 7, /S (similarly for 7). While no closed-
form expression exists for the variance e?(@) = Var[H(2)]
of this estimator, it can be well approximated [31] by
a second-order Taylor approximation around (jz, Jy)
which yields [30]

eax 7 (—e _ HaVarlye) =e) (5)

2 / 4 "
My My My

Note that for o9 = 1 and @ = (1,0,0,...) this reduces
o the standard error on the mean. We obtain the esti-
mated error €(@) by inserting the sample means Z for /1x,
che sample standard deviations at lax —£|?/(S—1)
or Var[a,] (similarly for y,) and the sample covariance
(ape — E)(ygw — ¥)/(S — 1) for Cov[z,, yx] into
Eq. (5). The covariance term captures the contributions
(0 the statistical error that arise from re-using the same
measurement samples to estimate all matrix entries.

The above statistical error propagation holds when
he POVM samples are independent and identically dis-
ributed (i.id.). In practice, for POVMs from random-
ized measurements (such as CS), it is often experimen-
cally convenient to take multiple measurement shots for
each randomized readout basis, which violates the i.i.d.
assumption. In this case, we can redefine the random
variables x, and y, as their averaged value over all re-
peated shots taken in the same measurement basis. In
this way, the obtained values for x; and y, remain i.i.d.,
and Egs. (4)—(5) remain valid for solving the constrained
optimization problem from Eq. (3).

Besides substantial efficiency gains from evaluating
the matrix entries of the subspace expansion in paral-
lel rather than sequentially [23], our approach based on
IC measurements offers two additional advantages over

0.6
=) 2 fo
St 05 ww
Bis o4 &
3 a
3 , os §
g 2 FI A
z Effo2 =
2 &
B25 0.1
a
0.2
0.0 ©
02 04 _ ¥
Ot 08 10 yo 02
FIG. 1. Subspace expansion as a constrained optimization

problem. The z axis shows the estimated energy H(é) when
varying two dimensions of the subspace coefficients ¢, while
color indicates the statistical error €(@) of the energy estima-
tion. Naive minimization of the energy (red arrow) may yield
an energy with high statistical error that can severely vio-
late the variational principle (black circle indicates the true
ground state energy). Constrained optimization with a max-
imum allowed error €max avoids statistically unstable regions
(blue path). Data corresponds to experiments presented in
Fig. 2 for N = 48 and g = —0.5.

traditional methods. Firstly, the expansion operators
{o1,...,¢,} can be chosen a posteriori after measure-
ments have been taken, as also pointed out by Ref. [26].
Thus, the same measurements can be reused to itera-
tively optimize the chosen expansion operators to mini-
mize the energy while the constrained optimization guar-
antees that the variational principle is respected up to
the chosen statistical precision €max. Secondly, the frame-
work offers the flexibility of estimating additional observ-
ables O for the obtained energy-optimized state without
additional measurements by constructing the estimator
O(Gopt) equivalently to Eq. (4) (replacing all occurrences
of H with O) where Gp is the solution to Eq. (3).

Experimental demonstration— We experimentally
demonstrate our method by addressing the task of re-
covering the ground state energy of a Hamiltonian with
known approximate ground state preparation circuits.
We consider a one-dimensional spin chain originally stud-
ied in Ref. [32] described by the Hamiltonian (with peri-
odic boundary conditions)

N
H= S (-922ZiZig1 — GeXit GrazZiXiziZiz2) (6)
i=l

where the parameter trajectory (for g € [—1,+1])
(gz2(9):Gx(9)-92e2(9)) = (20 —g"), (+9), (g-1)”)
traverses a quantum phase transition with a critical
point at g = 0 between a symmetry-protected topologi-
cal (SPT) phase where the ZX Z-terms dominate, and
a trivial phase where the X-terms dominate. Along
this trajectory, the ground state of the model corre-
sponds to a translation-invariant normal matrix prod-

uct state (MPS) [33] with an energy density E,./N =
—2 (9? + 1). We implement the latter as a quantum cir-
cuit leveraging a recently introduced algorithm based on
the renormalization-group transformation that approx-
imately prepares the MPS with an error 6 in depth
O (log(.N/6)) [34]. The approximation is determined by a
“blocking number” q which navigates a trade-off between
circuit depth and the fidelity of the prepared state. Here,
we opt for a blocking number of g = 4 which has been
shown to be a reasonable choice for current noisy quan-
tum hardware [35].

We implement the MPS ansatz circuits with system
sizes increasing from N = 16 with 108 entangling CZ
gates to N = 80 with 540 CZ gates on the IBM Quan-
tum superconducting qubit device ibm_fez of the Heron
R2 generation, see Appendix Al for details. We mea-
sure an IC POVM that consists of uniformly randomized
single-qubit X, Y, and Z measurements (standard local
classical shadows with canonical duals [28], see also Ap-
pendix A 3). For each studied system size N and param-
eter value g, we perform measurements in 32,768 bases
with 8 shots per basis. This POVM can efficiently esti-
mate observables of low Pauli weight w with statistical
errors increasing exponentially with w [7]. Hence, in prin-
ciple, we could now choose any set of sufficiently local ob-
servables as expansion operators 0; of the subspace. We
first select 7; = 1 to ensure that the original state po is
part of the subspace. In this way, the subspace-optimized
energy can never be worse than the measured one. Next,
we choose 02 = H to boost the ground state population
in the spirit of Krylov subspaces. Along these lines, one
would then ideally like to add more powers of the Hamil-
tonian as expansion operators. However, in our model
02 = H already leads to a term H2 2 = Tr [po H?] which
is an observable with 2.14 x 10° Pauli terms at N = 80.
The trace of each of these Pauli terms with each measured
dual operator (which are 262,144 in our case) needs to
be evaluated. The inclusion of 03 = H? would result in
a term H3 3 = Tr[poH®| with 35 x 10° Pauli terms and
strings with weight up to w = 15. These both exceed our
available classical processing resources and are beyond
the scope of estimation with single-qubit classical shad-
ows. We hence limit ourselves to one Krylov dimension
and label such expansion sets as “Krylov” = {1, H}.

Instead of increasing the Krylov dimension, we further
lower the energy by systematically adding low-weight
Pauli expansion operators with a strategy proposed simi-
larly in Ref. [26]. For Pauli weights w € {1,2,3,4,5}, we
sample 150 Pauli strings of weight w uniformly at random
to form a pool P,,. For each P; € P.,, we perform a two-
dimensional subspace expansion with operators {1, P;}.
We then rank the Pauli strings within each pool accord-
ing to the amount by which they reduce the energy rel-
ative to the unmitigated estimate, when optimizing for
the lowest upper error given by arg ming H(¢) + é€(¢). Fi-
nally, we include up to five of the best-performing Paulis
for each considered weight into the set of expansion op-
erators, see Appendix B1. Together with oj = 1 and

— exact ground state theory -> unmitigated

N N=32

-& “Krylov” subspace & “Krylov” subspace

N—48 N-64

ee,

FIG. 2. Error mitigation with subspace expansion based on IC measurements of ground state preparation circuits for a spin
model. The qubit number increases from left to right from N = 16 to N = 80 while the three rows show the energy density and
the order parameters of the traversed phase transition. Error bars represent the estimated statistical error €(€) and the inlays
show the chosen physical qubits of the 156-qubit device ibm_fez. For N = 16, grey shaded curves show the theoretical values
for the lowest 25 excited states obtained with exact diagonalization, with a color gradient from black for the ground state to

lighter shades for progressively higher-excited states.

o2 = H, this results in a subspace which we refer to
as “Krylov+”. The total numbers of single-qubit Pauli
traces of the form Tr[P;P;], P;, P; € {I, X,Y, Z} between
dual operators of measurement outcomes and the obsery-
ables of the subspace range from 4.3 x 10"! for N = 16 to
5.6 x 10!° for N = 80, see Appendix A 3. For both con-
sidered subspaces, we solve Eq. (3) with the constrained
optimization by linear approximation (COBYLA) algo-
rithm [36]. The allowed maximum errors €max were cho-
sen as a fixed multiple of the unmitigated signal to en-
sure a signal-to-noise ratio ranging from 5% for N = 16
0 15% for N = 80, see Appendix B3.

The results for the error-mitigated energy densi-
ies of the MPS ground state circuits for g €
{—0.9, —0.5, —0.1,0.1,0.5,0.9} are shown in the top row
of Fig. 2. Across all studied system sizes, the “Krylov”
subspace already significantly improves on the unmiti-
gated energies, while the “Krylov+” approach manages
o accurately recover the true ground state expectation
values while respecting the variational principle within
statistical uncertainties. As the system size increases,
he statistical errors of the unmitigated results become
rogressively worse which leads to larger error bars also
for the mitigated values. For the smallest system size of
N = 16 we can perform an exact diagonalization of the
Hamiltonian to get the full low-energy (density) spec-
rum. This reveals that several states lie between the

unmitigated and “Krylov” values and the true ground
state. However, the “Krylov+” values lie well below the
first excited state, indicating that the optimized subspace
state indeed manages to produce significant overlap with
the true ground state.

The phase transition at g = 0 is characterized by order
parameters which serve as interesting additional observ-
ables for which we can reuse the IC measurement sam-
ples. While SPT phases in general are characterized by
non-local order parameters, they can be expressed as lo-
cal operators for the considered MPS ground states [33].
Sh = pay X;/N signals the trivial phase. It is zero
for states with g < 0 and goes to 1 with g > 1 as
4g/(1 +g)’. Similarly, the SPT phase is characterized
by S2¥ = pay Z5Yj41%542Yj432)44/N which remains
zero for g > 0 and goes to 1 with g > —1 as —4g/(1—g)?.
The obtained values for $* for the energy-optimized sub-
space state indeed improve over the unmitigated values
for high g values, see second row of Fig. 2. However,
the weight-five observable $Y shown in the final row
of Fig. 2 is more difficult to mitigate. While the results
recover some of the theoretical behavior for N = 16, the
statistical uncertainties in the “Krylov+” values domi-
nate at larger scales. From this, we conclude that, while
the energy remains well-mitigated throughout all system
sizes, the recovered subspace state does not provide suf-
ficient overlap with the ground state to accurately reflect

complex observables like

gee,

Discussion— In this work, we presented the first large-

scale implementation of quantum subspace expansion

owered by classical shadows. Leveraging the high sam-
ling rates of state-of-the-art superconducting quantum
rocessors, we collected measurements in 32,768 ran-
domized bas
cally processed over one hundred trillion in
races. This not only represents the realization of clas
sical shadow measurements at an unprecedented scale,
ut also offers a blueprint for future workflows combin-
ing quantum and high-performance classical!

'$ per input state and subsequently classi-
ividual Pauli

computing.
Our results constitute a viable path to overcoming the

measurement overhead of QSE, and include — as a key
echnical
its statis

contribution — a complete characterization of
ical error bars in the presence of covariances

arising from the use of IC data. Furthermore, our exper-

iments underscore the potential of QSE as
model-agnostic error mitigation technique [
contrast
an accurate device noise characterization.

metry verification [14], powers of the root
pirit 0:
ods [11].
means [7
her re

S

t

a fully noise
6], which, in
‘o other methods [24, 37, 38], does not rely on
Our approach could be extended by incorporating sym-
state in the
virtual distillation [31] and multi-reference meth-
Additionally, estimators based on medians-of-
or dual frame optimization [39-41] could fur-
uce the sampling costs.

J. Tilly, H. Chen, S. Cao, D. Picozzi, K. Setia, Y. Li,
E. Grant, L. Wossnig, I. Rungger, G. H. Booth, and
J. Tennyson, The Variational Quantum Eigensolver: A
review of methods and best practices, Physics Reports
986, 1 (2022).

2] M. Larocca, S. Thanasilp, S. Wang, K. Sharma, J. Bia-

monte, P. J. Coles, L. Cincio, J. R. McClean, Z. Holmes,
and M. Cerezo, Barren plateaus in variational quantum
computing, Nature Reviews Physics , 1 (2025).

3] J. F. Gonthier, M. D. Radin, C. Buda, E. J. Doskocil,

C. M. Abuan, and J. Romero, Measurements as a road-
block to near-term practical quantum advantage in chem-
istry: Resource analysis, Phys. Rev. Res. 4, 033154
(2022).

4] M. Motta, W. Kirby, I. Liepuoniute, K. J. Sung, J. Cohn,

A. Mezzacapo, K. Klymko, N. Nguyen, N. Yoshioka, and
J. E. Rice, Subspace methods for electronic structure sim-
ulations on quantum computers, Electronic Structure 6,
013001 (2024).

5] K. Kanno, M. Kohda, R. Imai, S$. Koh, K. Mitarai,

W. Mizukami, and Y. O. Nakagawa, Quantum-selected
configuration interaction: Classical diagonalization of
hamiltonians in subspaces selected by quantum comput-
ers, arXiv preprint arXiv: 2.11320 (2023).

6] J. Robledo-Moreno, M. Motta, H. Haas, A. Javadi-

Abhari, P. Jurcevic, W. Kirby, S. Martiel, K. Sharma,
S. Sharma, T. Shirakawa, I. Sitdikov, R.-Y. Sun, K. J.
Sung, M. Takita, M. C. Tran, S. Yunoki, and A. Mezza-
capo, Chemistry beyond the scale of exact diagonaliza-
tion on a quantum-centric supercomputer, Science Ad-

I

on

is also worth noticing that only sufficiently local ob-

servables can be estimated efficiently when single-qubit
randomized measurements are employed. For accurate

groun

TOO

state recovery, our technique thus requires the
ate po to be at most a few local operators away

w

from the target state. Interestingly, this probes a regime

thai

is complementary to that of single-shot-based sub-

space expansion [5, 6], whose success hinges on the fact

thai

many
operators, such as shallow [42],

the ground state is only supported on polynomially
basis states. POVM measurements with less local
matchgate [43] or global

Clifford shadows [7] could therefore broaden the scope of

our

method.

Acknowledgements— We thank Moritz Scheer, Alberto
Baiardi, and Elisa Baumer for support on construct-

ing

MPS ground state circuits. We thank Guillermo

Garcia-Pérez and Oriol Vendrell for helpful discussions

in the early stages of the project.
acknowledge funding from the

Zon

L.E.F. and D.B.
European Union’s Hori-
2020 research and innovation program under the

Marie Skiodowska-Curie grant agreement No. 955479

(MOQS — Molecular Quantum Simulations).

This re-

search was supported by NCCR MARVEL, a National
Center of Competence in Research, funded by the Swiss
National Science Foundation (grant number 205602) and
by RESQUE, funded by the Swiss National Science Foun-
dation (grant number 225229).

vances 11, eadu9991 (2025).

H.-Y. Huang, R. Kueng, and J. Preskill, Predicting many
properties of a quantum system from very few measure-
ments, Nature Physics 16, 1050 (2020).

G. Garcia-Pérez, E.-M. Borrelli, M. Leahy, J. Malmi,
S. Maniscalco, M. A. C. Rossi, B. Sokolov, and D. Caval-
canti, Virtual linear map algorithm for classical boost
in near-term quantum computing, arXiv:2207.01360
(2022).

S. Filippov, M. Leahy, M. A. Rossi, and G. Garcia-Pérez,
Scalable tensor-network error mitigation for near-term
quantum computing, arXiv:2307.11740 (2023).

S.-X. Zhang, Z.-Q. Wan, C.-K. Lee, C.-Y. Hsieh,
S. Zhang, and H. Yao, Variational quantum-neural hy-
rid eigensolver, Phys. Rev. Lett. 128, 120502 (2022).

. Yoshioka, H. Hakoshima, Y. Matsuzaki, Y. Tokunaga,
Y. Suzuki, and S. Endo, Generalized quantum subspace
expansion, Physical Review Letters 129, 020502 (2022).
T. Takeshita, N. C. Rubin, Z. Jiang, E. Lee, R. Bab-
ush, and J. R. McClean, Increasing the Representation
Accuracy of Quantum Simulations of Chemistry with-
out Extra Quantum Resources, Physical Review X 10,
011004 (2020).

M. Urbanek, D. Camps, R. Van Beeumen, and W. A.
De Jong, Chemistry on Quantum Computers with Vir-
tual Quantum Subspace Expansion, Journal of Chemical
Theory and Computation 16, 5425 (2020).

X. Bonet-Monroig, R. Sagastizabal, M. Singh, and T. E.
O’Brien, Low-cost error mitigation by symmetry verifi-
cation, Physical Review A 98, 062339 (2018).

16

17

18

[19]

[20]

21

22

23)

24

26)

27

28)

29)

Z. Cai, Quantum Error Mitigation using Symmetry Ex-
pansion, Quantum 5, 548 (2021).

P. Suchsland, F. Tacchino, M. H. Fischer, T. Neupert,
P. K. Barkoutsos, and I. Tavernelli, Algorithmic Er-
ror Mitigation Scheme for Current Quantum Processors,
Quantum 5, 492 (2021), 2008.10914.

M. Motta, C. Sun, A. T. K. Tan, M. J. O’Rourke, E. Ye,
A. J. Minnich, F. G. 8. L. Brandao, and G. K.-L. Chan,
Determining eigenstates and thermal states on a quan-
tum computer using quantum imaginary time evolution,
Nature Physics 16, 205 (2020).

K. Klymko, C. Mejuto-Zaera, S. J. Cotton, F. Wudarski,
M. Urbanek, D. Hait, M. Head-Gordon, K. B. Whaley,
J. Moussa, N. Wiebe, W. A. de Jong, and N. M. Tubman,
Real-time evolution for ultracompact hamiltonian eigen-
states on quantum hardware, PRX Quantum 3, 020323
(2022).
W. Kirby, M. Motta, and A. Mezzacapo, Exact and effi-
cient lanczos method on a quantum computer, Quantum
7, 1018 (2023).
P. J. Ollitrault, A. Kandala, C.-F. Chen, P. K. Barkout-
sos, A. Mezzacapo, M. Pistoia, S$. Sheldon, S$. Worner,
J. M. Gambetta, and I. Tavernelli, Quantum equation of
motion for computing molecular excitation energies on a
noisy quantum processor, Physical Review Research 2,
043140 (2020).
J. Selisko, M. Amsler, C. Wever, Y. Kawashima,
G. Samsonidze, R. U. Haq, F. Tacchino, I. Taver-
nelli, and T. Eckl, Dynamical mean field theory for
real materials on a quantum computer, arXiv preprint
arXiv:2404.09527 (2024).

G. Garcia-Pérez, M. A. Rossi, B. Sokolov, F. Tacchino,
P. K. Barkoutsos, G. Mazzola, I. Tavernelli, and S. Man-
iscaleo, Learning to measure: Adaptive informationally
complete generalized measurements for quantum algo-
rithms, PRX Quantum 2, 040342 (2021).

S. Choi and A. F. Izmaylov, Measurement Optimization
Techniques for Excited Electronic States in Near-Term
Quantum Computing Algorithms, Journal of Chemical
Theory and Computation 19, 3184 (2023).

L. E. Fischer, M. Leahy, A. Eddins, N. Keenan, D. Fer-
racin, M. A. Rossi, Y. Kim, A. He, F. Pietracaprina,
B. Sokolov, et al., Dynamical simulations of many-body
quantum chaos on a quantum computer, arXiv preprint
arXiv:2411.00765 (2024).

M. Votto, M. Ljubotina, C. Lancien, J. I. Cirac, P. Zoller,
M. Serbyn, L. Piroli, and B. Vermersch, Learning mixed
quantum states in large-scale experiments, arXiv preprint
arXiv:2507.12550 (2025).

G. Boyd, B. Koczor, and Z. Cai, High-dimensional sub-
space expansion using classical shadows, Physical Review
A 111, 022423 (2025).

L. E. Fischer, D. Miller, F. Tacchino, P. K. Barkoutsos,
D. J. Egger, and I. Tavernelli, Ancilla-free implementa-
tion of generalized measurements for qubits embedded
in a qudit space, Physical Review Research 4, 033027
(2022).

L. Innocenti, S. Lorenzo, I. Palmisano, F. Albarelli,
A. Ferraro, M. Paternostro, and G. M. Palma, Shadow
tomography on general measurement frames, PRX Quan-
tum 4, 040328 (2023).

E. N. Epperly, L. Lin, and Y. Nakatsukasa, A theory
of quantum subspace diagonalization, SIAM Journal on
Matrix Analysis and Applications 43, 1263 (2022).

30

31

32

33

34

38

40

Al

43

44

ony

G. van Kempen and L. van Vliet, Mean and variance
of ratio estimators used in fluorescence ratio imaging,
Cytometry 39, 300 (2000).

W. J. Huggins, S$. McArdle, T. E. O’Brien, J. Lee, N. C.
Rubin, S. Boixo, K. B. Whaley, R. Babbush, and J. R.
McClean, Virtual Distillation for Quantum Error Miti-
gation, Physical Review X 11, 041036 (2021).

M. M. Wolf, G. Ortiz, F. Verstraete, and J. I. Cirac,
Quantum phase transitions in matrix product systems,
Phys. Rev. Lett. 97, 110403 (2006).

A. Smith, B. Jobst, A. G. Green, and F. Pollmann, Cross-
ing a topological phase transition with a quantum com-
puter, Phys. Rev. Res. 4, L022020 (2022).

D. Malz, G. Styliaris, Z-~Y. Wei, and J. I. Cirac, Prepa-
ration of matrix product states with log-depth quantum
circuits, Phys. Rev. Lett. 132, 040404 (2024).

M. Scheer, A. Baiardi, E. Baumer Marty, Z.-Y. Wei,
and D. Malz, Renormalization-group-based preparation
of matrix product states on up to 80 qubits, arXiv
preprint arXiv:2510.24681 (2025).

M. J. D. Powell, A direct search optimization method
that models the objective and constraint functions by lin-
ear interpolation, in Advances in Optimization and Nu-
merical Analysis, edited by S. Gomez and J.-P. Hennart
(Springer Netherlands, Dordrecht, 1994) pp. 51-67.

E. Van Den Berg, Z. K. Minev, A. Kandala, and
K. Temme, Probabilistic error cancellation with sparse
pauli—lindblad models on noisy quantum processors, Na-
ture Physics 19, 1116 (2023).
Y. Kim, A. Eddins, S$. Anand, K. X. Wei, E. Van
Den Berg, S. Rosenblatt, H. Nayfeh, Y. Wu, M. Zale-
tel, K. Temme, et al., Evidence for the utility of quan-
tum computing before fault tolerance, Nature 618, 500
(2023).
L. E. Fischer, T. Dao, I. Tavernelli, and F. Tacchino,
Dual-frame optimization for informationally complete
quantum measurements, Physical Review A 109, 062415
(2024).

J. Malmi, K. Korhonen, D. Cavalcanti, and G. Garcfa-
Pérez, Enhanced observable estimation through classical
optimization of informationally overcomplete measure-
ment data: Beyond classical shadows, Phys. Rev. A 109,
062412 (2024).

A. Caprotti, J. Morris, and B. Dakié, Optimizing quan-
tum tomography via shadow inversion, Phys. Rev. Res.
6, 033301 (2024).

C. Bertoni, J. Haferkamp, M. Hinsche, M. Ioannou,
J. Hisert, and H. Pashayan, Shallow shadows: Expecta-
tion estimation using low-depth random clifford circuits,
Phys. Rev. Lett. 133, 020602 (2024).

K. Wan, W. J. Huggins, J. Lee, and R. Babbush, Match-
gate Shadows for Fermionic Quantum Simulation, Com-
munications in Mathematical Physics 404, 629 (2023).
A. Javadi-Abhari, M. Treinish, K. Krsulich, C. J. Wood,
J. Lishman, J. Gacon, S. Martiel, P. D. Nation, L. S.
Bishop, A. W. Cross, B. R. Johnson, and J. M. Gam-
betta, Quantum computing with Qiskit, arXiv preprint
arXiv:2405.08810 (2024).

S. K. Lam, A. Pitrou, and S. Seibert, Numba: A Ilvm-
based python jit compiler, in Proceedings of the Second
Workshop on the LLVM Compiler Infrastructure in HPC
(2015) pp. 1-6.

Appendix A: Details on hardware demonstration
1. The ibm_fez device

Our experimental demonstration is performed through
a cloud-based access of the IBM Quantum 156-qubit de-
vice ibm_fez using Qiskit [44]. This device uses a native
gate set of {CZ, /X,R.} on a heavy-hexagonal topol-
ogy, see insets in Fig. 2 for the qubit layout. The device
achieved median values of T; = 136 us, Tz = 79 ps, av-
erage gate fidelities of foz = 2.8 x 107° and lysx =
4.4 x 10-4, and median readout errors of 1.6% at the
time of performing the experiments.

2. Details on circuits

For constructing the MPS ground state preparation
circuits of the considered spin model we follow Ref. [35],
including the strategy for mapping circuit qubits to hard-
ware qubits described therein, which is designed to min-
imize the number of required SWAP gates (and thus en-
angling CZ gates). The resulting numbers of two-qubit
gates upon transpilation is summarized in Tab. I. As
he transpiled circuits feature long idle times of several
qubits, see Fig. 3 for an N = 16 circuit, we apply dynam-
ical decoupling with an XX sequence on idling qubits.
The qubit layouts shown in Fig. 2 were chosen to op-
imize performance based on the reported qubit quality
metrics and gate fidelities.
As discussed in Ref. [35], the circuits only approx-
imate the true ground state of the Hamiltonian due
o a fixed point approximation error in the underlying
renormalization-group-based protocol. This approxima-
ion has been shown to be insignificant for |g| > 0.5 but
does introduce a noticeable error for the |g| = 0.1 cases.
In that regard, our experiments underscore that subspace
expansion not only serves the purpose of hardware error
mitigation but can also overcome small algorithmic er-
rors.

3. Classical shadow measurement

We perform randomized measurements known as
single-qubit Pauli classical shadows [7]. That is, we
sample a number of NV, different measurement configu-
rations where each qubit is measured either in the X,
Y, or Z basis (chosen uniformly at random for each
qubit), and take Ng individual shots in each measure-
ment basis. This has traditionally led to significant cir-
cuit overheads, as, in the most direct approach, this re-
sults in N, different quantum circuits that have to be pro-
cessed by the entire hardware stack. Instead, we leverage
a parametric circuit compilation pipeline facilitated by
the povm-toolbox repository and by the Qiskit Runtime
primitives [44], thus making randomized measurements

N 16 32 48 64 80

CZ gates 108 216 324 432 540

# Pauli traces for
PSE Krylov+ (x10")

é€max /Hunmit 0.05

0.4 2.9 11.3 30.3 56.3

0.075 0.1 0.125 0.15

TABLE I. Details on the experimental demonstration. The
number of CZ gates corresponds to the transpiled ground
state preparation circuits. The given number of Pauli traces
are the total number of single-qubit traces evaluated in post-
processing for each system size. The allowed error émax for
the constrained optimization is taken as a fixed multiple of
the unmitigated energy estimate Hunmit.

significantly more efficient. In this approach, each basis
rotation prior to readout is implemented as a parameter-
ized sequence of R,(63) x VX x R.(02) x VX x R.(61),
including the identity transformation for measuring in
the Z basis, for which the two VX pulses cancel. Hence,
only one pulse sequence template is processed by the de-
vice control stack and the sets of parameters representing
the different readout bases only correspond to different
phases on these pulses. This enables fast, hardware-side
parameter binding that allows us to explore significantly
more basis randomizations, namely N, = 32,768 with
Ns = 8, compared to previous classical shadow measure-
ments reported in the literature with comparable qubit
numbers (N. = 256 with Ng = 1024 for 91 qubits in
Ref. [24] and N,. = 2048 with Ns = 1024 for 96 qubits in
Ref. [25].) In total, the quantum circuit execution for all
results shown in Fig. 2 took & 1h of wall clock time.

A single shot of this randomized measurement proce-
dure is distributed according to the POVM {M,} with
n = 6% operators that are tensor products of single-qubit
operators My = Mb,,ty,...ky = Mi? @MO @---@M™
with the single-qubit POVMs My? = {$ 1s) (il}\;) where
lj) © {|0),]1),]+).|-).é),|-¢)}. The dual operators
used for post-processing are the canonical duals for which
{Mx} = {Dx} [39], hence the dual operators retain the
product structure of the POVM. We write all observ-
ables O, expansion operators o;, and dual operators D,
as linear combinations of Pauli operators. The traces
needed to evaluate Eq. (1) then boil down to products
of single-qubit traces between Pauli operators. This re-
sults in O(10!?) single-qubit traces we process to span
the “Krylov+” subspaces for each system size N (as a
sum over all g values), see Tab. I. Note that these traces
only have to be computed once and the stored results
can be reused to evaluate the cost function of Eq. (3) for
different values of ¢ during the optimization.

FIG. 3. Quantum circuit that prepares an approximate ground state of the Hamiltonian from Eq. (6) for N = 16 with g = —0.7

through a renormalization-group-based MPS ansatz (without readout

asis rotations used for classical shadow measurements).

The left panel shows the physical qubit layout used in the experimental demonstration. Red boxes represent single-qubit. VX

gates while blue boxes represent parameterized Rz gates.

Appendix B: Classical postprocessing
1. Expansion operator selection

Here, we detail the Pauli operators selected to con-
struct the “Krylov+” subspaces of our experimental
demonstration. As mentioned in the main text, we in-
cluded Pauli expansion operators o with weights ranging
rom w= 1 to w = 5. For each considered weight w,
he chosen Paulis of the subspace are listed in Tab. II.
Note that the total dimensions of the “Krylov+” spaces
is L = 27 for the smallest system size N = 16 but only
L = 14 for N = 80. This choice was made to keep the
ost-processing feasible to run on a standard laptop, see
Appendix. B 2. While this was sufficient to mitigate noise
in the energy estimation of the considered spin model cir-
cuits, the dimensions of the considered subspaces could
e significantly increased with high-performance comput-
ing resources, where the number of Pauli traces that need
0 be evaluated grows roughly quadratically in L.

2. Computational resources

Our classical post-processing is run on a standard laptop
with an Intel Core Ultra 9 185H CPU (16 cores, 22 threads, up
to 5.1 GHZ boost frequency) leveraging the Numba Python
package [45] for high-performance, parallelized Python code.
The computational bottleneck of our method is the evaluation
of the Pauli traces between subspace expansion operators and

measurement dual operators summarized in Tab I. In total,
the post-processing for our experimental demonstration took
= 20h.

8. Constrained optimization

Here, we present details on how the constrained optimiza-
tion presented in Eq. (3) is carried out in our experimental
demonstration. The central hyperparameter in our procedure
is the allowed maximal statistical error émax, which controls
a bias-variance-tradeoff. To illustrate this, we show an ex-
ample of how the achieved subspace energy gets reduced as
€max is increased, see Fig. 4a. When the allowed error be-
comes too large, eventually the subspace energy can violate
the variational principle, while the physical region remains
within the error bars. This manifests in the signal-to-noise
ratio of the energy density Fl (@pt)/(Némax) which decreases
roughly as a power law with émax, see Fig. 4b. This moti-
vates choosing the allowed error in our experimental demon-
stration as a fixed multiple of the unmitigated signal of the
energy estimation Hunmit = H ((1,0,...)). This ratio ranges
from 5% for N = 16 to 15% for N = 80 to account for the
increase in noise with the system size, see Tab. I. As an initial
point of the COBYLA optimization, we choose the parame-
ters €= (1,0,0,...) that correspond to the unmitigated base
state po. We find that the optimization converges with, on
average, 1438 iterations.

Besides the constrained optimization, another way to deal
with statistical uncertainties in quantum subspace expansion
are regularization techniques as suggested in, e.g., Ref. [13].
This approach aims to overcome potential ill-conditioning of
N] 9 selected Paulis
16 | -0.9 Za, Xz, Xs, Ya, Xi2, YiX2, ZsZi2, ZsZio, X2Z.0, ZrXu, ZsX1aZie, Z2X13Yia, ZiY2X7, Z2Z1Zu, YiYoXu, YioX13Z14Yis,
YoZ3X7Xi1, ZYiuiX12X16, YsYoZiZi6, ZsZi2VisXie, Yi¥sZeZuYis, Z:X2¥sZeYi2, ViXe2VaX7Zu1, YiZsZoZoXu, ZsYaYisX14Zi5
16 | -0.5 Xo, Zo, Zr, Zia, Yir, YeXt, ZoZie, ZsZe, ZoZio, Z1Z13, ZiYsZi2, Xi2ZisZis, YsYoYi2, YioX1aXis, XoXisXis, YeYoXi1X1s,
ViYeZrYs, Y2¥sXeYs, X2X7XsZo, ZoXsXiYir, YiZ2¥sZiaXis, ViZsY7VisZis, ZiXaZ5Xo0Yir, YeY7YioZuZie, X1ZsYsY7Zi5
16 | -0.1 Zi, Zi, Zs, X13x, Za, Z:Z7, ZiZr2, ZZ, ZoZr0, ZisZis, Z2Z3X0, XsXioZi2, Z2X7Zo, Z3ZsX6, YsZsZio, ZsZeZ7rZisy
XoZZuZi4, Y3sVs2Z2sZ15, Z2YsZi1Z16, XsZoZioZ11, X2YsY6YsYo, Z:Z3ZoVisYie, Xi¥aYisZuYie, Yr¥sZuXisXis, Z1Z5Zi0YiaXis
16 | 0.1 Xio, Xigy Xty Nav Nay ZoZisy Zo, XiXra, XioXury ZiaZry ZioZuXiar XaZeZr, XrwZistas, ZXoZiny ZaZioZrw, XoYioZsaXe,
Ui Bike Wists GARG Be Billa ZiGlabs BAR Oe, VER Wat ore
16 | 0.5 | Xo, Xray Xuy Xs, Xar XsXra, XuXis, XeXr2, XioXis, XX, XioXiXis, XeXeXury XeXeXr, XeXrXe, ZoZuXis, XaXrXr9Xis,
X2XioXisXia, X2XsXuXia, XaX10Zi4Zis, X7XsYioZ1a, Z3aXsYioZuXis, XiY2¥aXi2Zia, ZsYeX12ZiaZie, ZaYsXoVi2¥is, Zi Z7XsZisX16
16] 0.9 Miz, Xu, Xs, Xa, Xo, XsXio, X7X10, XoX10, XuXis, XioX1e, XsXsXo, X2XuXis, XsX7Xu, X2XsXo, XsX7Xis, XsXoX12Xis,
XsXoXi0X1a, XsXrXsXi2, XiX2X7Xie, XeXsXiuXi2, XsYeXioXuXie, X2YsX7XisVis, YoXsXuNXiwXia, Y2YsYeNoYis, XiY2XuYi2Vie
32 | -0.9 Zu, Zs, Zis, X20, ZaXz, YirZar, ZioX26, Z2Z23, X20Y22Yea, XoX24Z31, YrZisZ27, ZsZ22Xs1, XoXsZ7Zs,
ZaX21ZorX30, Z2YsYi2X16, Y2Z5X7Xsi, X1aYisX25ZesXs1, Xi ZeYisZieZi9, Z11Z19Z23Y25Yee, YrYisX2sX30Xs1
32 | -0.5 Zsor Zi2y Ziy Zor Zio, ZoZo, ZrZo, XsXv2, ZoXorZ20, Za%Zi2, XrZraXsoy XoY20Xsoy ZsYsZi2Xi0,
Zs¥i2Vi0Z05, Z1Y22Z26Z28, YsYsYirYo3, YoYiaXisYo3X01, YsX12Zi6Z23Z26, Z2YioZ11XisX23, XsYoX17YioX23
32 | -0.1 2o5, Zar, Zr, Lea, ZisZis, ZZ, Zo5Z26, ZieZis, XaYi2¥i0, Zi2Z22X2a, Zr1aZisYoo, ZiXeZ20, ZoX28Y20X30,
Zi9Z22Z28X31, Zi1aZ20YoiZoa, ZrrYi7ZisZs1, YsYieZ26YosX31, Zi X7YisZo0Zo8, 22Z13Z241Zo7Zs1, ZsYoZ20X27Zo8
32] 0.1 Xo, Xso, Xi, Xi2, Z25Z26, Z2Z28, ZoZ29, XsX29, Z3XsZis, XoZesZs1, XisYizY22, ZiZi2Zos, Zi Z141Z20Z25,
YoXuYes¥a1, ZisZ26Z27Z20, YiaX2aYosZo0, YoYiXeXsYie, XiXsYuZieZir, XaYwYi2ZisYio, YoZsYioZ21Zoa
32 | 0.5 Xi, Xo, Xtor Xtoy XirX20, XsXo8, XsXio, XaX10, XriXo2Xve, XrXirXo1, XoXioXer, XsXoX2s, XsXoXuXi6,
Z2Z6Yr2eZor, XaX13X17Ys1, YoZ22X23Z30, X1¥i2¥20X241X26, ZoYsaX10ZisX30, Xi0ZuYieXi7Xs1, YaX19Z21X22X23
32] 0.9 Xi, Xo, Xio, Xs, X11X20, XsX10, XiXs, XioX20, XoX20X30, X1X24Ys1, YsX20X25, XisYisX31, X21 X22Xs0X31,
Y3¥iZisZ30, YoZi2Xi7Za1, LZoZ1sZ17Yo2, XoX10XisXisXi9, XoY2XieX23Xsi, XoZsXirXisXi9, X2VioYiaXisX20
ae | -0.9 Zaz, X29, Zn, Yas, ZoeXu, Vslos, XigXos, Vila, ZYaXs, Zalsikes, Yosls2Xes, ZralasXue, DalisXnXos,
XisYssXa2Var, XsXuZisXie, ZsZ1eZi7X32, YsYiaYisZ20Xs6, YsX12Z30Xa5Yae, Yi2Y2s1X20Zs6¥s7, X11X17Z22X27Zs0
48 | -0.5 Ziv, Zia, Zio, Zs, X2X19, YirXe3, ZsXa2, ZrsZ20, XoZs5Z36, XeY23Z20, ZoZsYis, XsZioXsa, X19¥22Zo7Zas,
XigXoVoaZ, ZisXi7Z20Z22, ZoaZo7VesXa6, Zs ZrsYosZorZaa, YrZi1YosXsoXas, X2ZaXwYuYie, X20Zs1XasYui Zaz
48 | -0.1 233, Zs, Zs0, Ze, ZaoZas, 232%33, ZsiZ35, Z7Z20, ZoZivZas, ZiYsaYac, XoYo3Za7, ZisaXi9Z21, ZoZieZo0Zs1,
Z2Yo8Z35Ya6, X2Z13Z3Za7, Zi1Z36ZssYs9, ZsX10X26V33Yas, Zi9¥25YoeZs2Xa0, X5¥7¥22Yo8Z35, ZaXsYoZa1 Ye
4g) 0.1 Xo, Xit, Xss, Xss, ZaZo, XesZsr, XaXso, ZisZa2, ZroZs2Xas, YaZorYox, XisXsrXac, XisZieXa, Yi2Z0Zs2Zso,
Y2¥isZ33Za5, X1Z24Ys1Za5, YoiY22Z33Z40, ZsX11X20¥s1Ya2, 25Z11ZisZ21Z30, YoX1sX16YioZs2, XoYoZ28Ys5Xs7
48] 0.5 X35, Xso, Xas, Xae, XisXi9, XoXsi, XssXaz, XeXaz, XsX20X35, XaXsXie, XoX1sXaz, XisX24X3s, XisXi9X20Xaz7,
XiiX2iXa6Xae, XisXieXioXas, XoX12X20¥ar, XsX20X27Z33Xae, ZisX24X28Vs0Zs2, XirXisX21Xe7Y20, Z6Z14Z32Xs8Zar
48] 0.9 Xio, Xi2, Xs0, Xos, XiurXia, XasXaa, Xi2Xi9, XsX22, X3X27X20, NXaX7X1is, X2XieXo7, NXsX7Xa2, XisX21X36Xa5,
X3X12Xo5Xs1, XisX20X42Z44, ZoZ22Xs0X40, XsYi2X26Z30Z38, X12ZisXi9oX28Xs0, ZoX1aX25Xa3Yus, Zia Y28Ys2Xs8Za7
64 | -0.9 Zsa, Zrry Yor, Za, XoZio, X7Zsa, YosZ26, YisXas, YoX13Z26, XsaZasXaz, ZoXsaXa3, YaZ20Z57, ZsX19Z52Zs0,
Z39ZseXs0Z00, XoXsXi1X28, YasZasYso¥o2, ZisXisXieZizXae, XisX35Xa7Xa6Yao, Zi X21 Ys1¥ieXa7, X28Z31Zs2YsoXo1
64 | -0.5 Zsa, Zis, Zox, Z30, YisYia, Yi2Z1a, YoZio, Yi7¥ar, ZeX1Yo1, Z20¥ssXo1, YisXs3Zo2, XoX20Z38, Z5X28ZasZas,
ZuX5YosX5e, 23X31 ZseZo3, YsZ7Zs2Vo7, Yo1Z26Y30ZseXs8, ZrX19ZssX57X59, Z2X20Xs6Ya2Xo1, YiX7XsZo6Xs0
64 | -0.1 Zusy Zrs Zao Xre, ZoZeey Zi.Zoe, Zi2Zeay ZivYea» ZioZeoZery ZorXa.Zoar YirZseXeor ZaaVeeZesr XrYauZeoXee,
ZoZs6Yo2Xo3, ZoX12Yi0Z20, YisX21Z24aXe3, X7YsaXa0X6o0¥es, Zis¥isZ1sZeiXe2, Y2Xs3Zs6ZaoXs7, YoZs0YisX17Za9
64 | 0.1 Xe2, Xs0, Xae, Xia, Z1Z6, Zs7Zoe, Zi2Zsa, XsXur, Xi7rXarX: XeZasXae, X12Ys5¥as, ZoZssYo2, 23Z15Z52Zs9,
Yaa¥aoXorZss, X2iXss¥s0%so, YasXuXsoZsi, YoZieZ20ZuZss, Yo2¥ssXss¥o0Zos, XeZs0Zao¥i2Zss, ZsYisZr0Z20Zas
64 | 0.5 X10, Xoo, Xaev Xtar XsoXarr XsXo2, XsXo0e XsXeer XarXoaXaor XsXuaXse, XuYseXe2e ZoZoxZay XisXoXaXso,
XrXigXs3X58, Z11ZisZs2Zo1, YrZi7ZssXa5, X2vZs7XaeYioXs0, XsX1s¥icYioXsa, Z1X20X25Z33Yes, X16-X20Y23X30 Yoo
64] 0.9 Xie, Xis, Xse, Xis, XsXie, XiaX25, XssXs7, Xs0Xs0, NXsXiuXs7, XisX28X53, X20Xs3X5s, XsX21X40, XoXsXs4Xas,
XoXaeXa7Z58, XsZo0Xs0X5a, Yis¥33Z35Z50, Y2Z26X4sZ51Xo2, ZoXsZsZioXes, YiYsXaY32Ze2, Y31ZseYs0Ze2Xo3
80 | -0.9 Ziv, Yr, Ya, ZoXs0, ZoZas, X39ZseXs1, XieZs0Zs9, YsZs0Xa1Ys2, XseXasXso¥os, XisX3sZa1ZeaXos, ZsY20X21Zo3Z72, X2ZoY22YseZ70
80 | -0.5 Xs, Za, Ze, ZirYoa, ZaZr2, XsoZsaZ53, Z2ZsZis, YioXsoXeaZm, XsZiaXsiXsr, Xi7X21Xs0Ze2Yos, ZaX1aXisXssZaz, YoZ26X20ZseX73
80 | -0.1 Zi, Zea, Za, Z2Z11, LZaoZse, 233Z52Z50, Z3sXa9X75, X3XioXieXr9, X36ZasYssYr0, ZoZ22¥siYesZos, YsZoeXs1X52Ze0, Y3Zs3Xs6Z71X79
80} 0.1 X25, Za, Zit, ZssZo0, XssXr1, Zo7ZssYao, XiYisYo0, XioXs0¥3eXe3, X24Ze0ZeiYoo, YisYoaZo5Z73Z76, ZrYieXs4Ze0Xes, YeYi1¥26Zs5Ze2
80 | 0.5 Xai, Xs, Xa, XisXo7, XaiXs5, XsXioXco, Xs6X5iX7s, ZoXiaZasXs1, XsX10Z22Z77, ZoX12Y20Zs9Xo6, ZoXsX2aXs7X56, Z29VasXo1Zr1Yr7
80 | 0.9 | X22, X20, Xiz, XosXvo, XarXer, XirXa9Xr7, XisNsvXr7, NXoX20XaiXor, ZsiXaaXsaXrs, Zar YieXseXooXes, YsXi6X3sZ5aX73, YoZisXa7Xs3Yeos
TABLE II. Selected Pauli expansion operators of the “Krylov+” expansion set for each values of system size N and Hamiltonian

parameter g considered in our experimental demonstration.

the overlap matrix S and solves the generalized eigenvalue ergies in the subspace states as exemplified on the experimen-
problem by computing the lowest eigenvalue of S-'H with a tal data of the “Krylov+” subspace for N = 48, see Fig. 5.
regularized overlap matrix Ss. S-! may be computed based on We find that up to six singular values need to be discarded
a singular value decomposition S = UGV, where G is a diago- (out of a 22-dimensional subspace) to respect the variational
nal matrix with singular values s;. The problem is regularized principle, underscoring the ill-conditioning of the generalized
by setting the diagonal entries in G~* = diag(1/si,...1/sz) eigenvalue problem. Moreover, in contrast to our constrained
to zero for the smallest singular values and computing sos optimization procedure, this method does not provide tunable

V'6~'U". This enables the suppression of non-physical en- statistical error bars.
— _ unmitigated

- 10! .

SNR AC

lo? 10-T 10° lo? 197 10"
allowed statistical error €inax allowed statistical error €inax

FIG. 4. Bias-variance-tradeoff in the constrained optimiza-
tion problem. a) Obtained subspace energy density when
solving the constrained optimization for increasing error bud-
gets €max. The horizontal lines are the unmitigated energy es-
timate Hunmit (red) and the true ground state energy (black),
while the vertical dashed line signals the statistical error of
Fiawsnve: b) Decrease of the signal-to-noise-ratio (SNR) of the
mitigated energy density with émax. Data corresponds to ex-
periments with N = 48 and g = —0.5.

Fey
o

—@ 0 SVs discarded
—@— 2 SVs discarded
7 ee {
oe
— theory
—10 @ constrained optimization J
—1.00 —0.75 —0.50 —0.25 0.00 0.25 0.50 0.75 1.00

g

FIG. 5. Suppressing non-physical energies through regulariza-
tion of the overlap matrix on experimental data for N = 48.
Data points with solid lines show the smallest pseudoeigen-
value when discarding the indicated number of the smallest
singular values (SVs). Data points with error bars correspond
to the “Krylov+” subspace results from Fig. 2. Note the non-
linear y-scale for better visibility.

10
